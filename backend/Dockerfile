FROM ktech4.azurecr.io/python:3.8-slim

WORKDIR /app
COPY requirements.txt .
RUN pip install --trusted-host pypi.org --trusted-host pypi.python.org --trusted-host files.pythonhosted.org -r requirements.txt

# ë¨¼ì € ì „ì²´ ì†ŒìŠ¤ ì½”ë“œ ë³µì‚¬
COPY . .

# Secret Key ìƒì„± ë° í™˜ê²½ë³€ìˆ˜ ì„¤ì •
RUN python generate_secret.py > /app/.env
RUN echo "FLASK_SECRET_KEY=$(cat /app/.env)" > /app/.env

EXPOSE 5000

# ğŸš€ OpenTelemetry ìë™ ê³„ì¸¡ìœ¼ë¡œ ì‹¤í–‰ (ì½”ë“œ ìˆ˜ì • ì—†ì´ ëª¨ë“  ë¼ì´ë¸ŒëŸ¬ë¦¬ ìë™ ì¶”ì !)
CMD ["opentelemetry-instrument", "python", "app.py"] 